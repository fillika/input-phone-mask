!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["easy-phone-mask"]=e():t["easy-phone-mask"]=e()}(self,(function(){return function(){"use strict";var t={r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t){const e=/(\D+)|(\s+)|(\d+(?=\]))|(\d)/gim,n=[];let i;for(;null!==(i=e.exec(t));)i.index===e.lastIndex&&e.lastIndex++,n.push(i[0]);return n.filter(Boolean)}function i(t){const e=t.slice(0,t.length-1),n=t.replace(e,"");switch(isNaN(Number(n))||" "===n){case!0:return i(e);default:return e}}function s(t){const e=[],n=/\[\d+\]|\d+/gm;let i;for(;null!==(i=n.exec(t));){i.index===n.lastIndex&&n.lastIndex++;const[t]=i,l=t.match(/\[\d+\]/gm);if(null!==l)e.push(s(l));else{t.split("").forEach((t=>{const n=9===Number(t)?"(\\d)":`[${t}]`;e.push({length:1,regExp:n})}))}}function s(t){let[e]=t;const n=e.match(/\d+/gm)[0],i=n.length,s={length:i,regExp:""};if(i>=2){const t=/(.)(?=.*\1)/gm,e=n.replace(t,"");s.regExp=`^[${e}]+$`}else s.regExp=`[${n}]`;return s}return e}function l(t,e){const{prefix:n,countryCodeTemplate:i}=e;return`${n}${""===i?i:i+" "}${t}`}t.r(e);var o=class extends class{constructor(t,e){this.defaultConfig={prefix:"",countryCode:"",mask:"(999) 999-99-99",placeholder:!1},this.config={mask:(null==e?void 0:e.mask)||this.defaultConfig.mask,countryCode:(null==e?void 0:e.countryCode)||this.defaultConfig.countryCode,placeholder:(null==e?void 0:e.placeholder)||this.defaultConfig.placeholder,prefix:(null==e?void 0:e.prefix)||this.defaultConfig.prefix},this.state={value:"",config:this.config,myTemplate:s(this.config.mask),prefix:this.config.prefix||"",globalRegExp:new RegExp(`${this.config.countryCode}`),countryCodeTemplate:`${this.config.countryCode}`,parsedMask:n(this.config.mask)},this.input=t}}{constructor(t,e){super(t,e),this.inputEventFocus=this.inputEventFocus.bind(this),this.inputEventInput=this.inputEventInput.bind(this)}init(){this.input.addEventListener("focus",this.inputEventFocus),this.input.addEventListener("input",this.inputEventInput),this.setPlaceholder()}inputEventFocus(){if(0===this.input.value.length){this.input.value=this.state.value=this.state.prefix+this.state.countryCodeTemplate;const t=setTimeout((()=>{this.input.selectionStart=this.input.selectionEnd=this.input.value.length,clearTimeout(t)}),10)}}inputEventInput(t){if(void 0!==t.target&&null!==t.target){const{value:e}=t.target,{inputType:n}=t,s=this.state.prefix+this.state.countryCodeTemplate,o=function(t,e){return e.input.selectionStart<=(e.state.countryCodeTemplate+e.state.prefix).length?e.state.value.replace(e.state.globalRegExp,"").replace(/\D/g,""):t.replace(e.state.globalRegExp,"").replace(/\D/g,"")}(e,this);switch(n){case"insertText":const t=function(t,e){const n=[];if(0===t.length)return n.join("");let i=e.myTemplate.map((t=>t));for(let s=0;s<e.parsedMask.length;s++){const l=e.parsedMask[s];if(0!==t.length)if(""===l||" "===l)n.push(l.replace(/\[|\]/,""));else if(isNaN(Number(l)))n.push(l.replace(/\[|\]/,""));else{const e=t.slice(0,l.length),s=i.shift(),o=new RegExp(s.regExp,"gi"),a=e.match(o);t=t.slice(l.length),null===a?n.push(e.slice(0,e.length-1)):n.push(e)}}return n.join("")}(o,this.state);this.input.value=this.state.value=l(t,this.state);break;case"deleteContentBackward":const n=this.state.value.replace(e,"");if(1===n.length){(isNaN(Number(n))||" "===n)&&(this.input.value=i(e))}this.input.value.length<=s.length||this.input.selectionStart<=6?this.state.value=this.input.value=s:this.state.value=this.input.value;break;case"insertFromPaste":this.input.value=this.state.value=l(function(t,e){let n=e.myTemplate.map((t=>t));const i=[];t:for(let s=0;s<e.parsedMask.length;s++){const l=e.parsedMask[s];if(0!==t.length)if(""===l||" "===l)i.push(l.replace(/\[|\]/,""));else if(isNaN(Number(l)))i.push(l.replace(/\[|\]/,""));else{const e=t.slice(0,l.length),s=n.shift(),o=new RegExp(s.regExp,"gi");e.match(o),t=t.slice(l.length);for(let t=0;t<e.length;t++){const n=e[t];if(null===n.match(o))break t;i.push(n)}}}return i.join("")}(o,this.state),this.state)}}}setPlaceholder(){"boolean"==typeof this.config.placeholder&&this.config.placeholder?this.input.placeholder=this.state.prefix+this.config.countryCode.toString():"string"==typeof this.config.placeholder&&(this.input.placeholder=this.config.placeholder)}};class a extends o{constructor(t,e){super(t,e),this.init()}static toGlobalWindow(){window.EasyPhoneMask=a}reinit(t){this.unmask(),new a(this.input,t)}unmask(){this.input.value="",this.state.config.placeholder&&(this.input.placeholder=""),this.input.removeEventListener("focus",this.inputEventFocus,!1),this.input.removeEventListener("input",this.inputEventInput,!1)}validation(){}}a.toGlobalWindow();return e}()}));